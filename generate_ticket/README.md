# 自定义行程图生成器使用说明

## 程序功能
该程序是一个纯前端HTML应用，允许用户通过表单输入「始发地、目的地、称呼、时间」4个字段，然后将这些信息绘制到指定的模板图片上，生成个性化的行程图并提供下载功能。

## 快速开始

1. **准备模板图片**
   - 将您的模板图片命名为 `template-bg.jpg`，并放置在与 `index.html` 同一目录下
   - 模板图片尺寸建议为 800x500 像素，以获得最佳效果

2. **启动程序**
   - 直接在浏览器中打开 `index.html` 文件
   - 或通过本地服务器（如 `http-server`）访问该文件

3. **使用流程**
   - 在表单中填写或修改「始发地、目的地、称呼、时间」信息
   - 点击「生成图片」按钮
   - 等待图片生成完成（按钮文字变为「生成中...」）
   - 在预览区域查看生成的图片
   - 点击「下载图片」按钮保存图片（文件名为「自定义行程图.png」）

## 自定义配置

### 1. 替换模板图片

**方法一：直接替换文件**
- 准备您自己的模板图片（建议800x500像素）
- 将图片重命名为 `template-bg.jpg`
- 替换原文件即可

**方法二：修改图片路径**
- 如果您想使用不同的图片文件名或路径，可以修改 `index.html` 中的以下代码：

```javascript
// 模板图片
const templateImg = new Image();
templateImg.src = 'template-bg.jpg'; // 修改这里的路径
```

### 2. 调整文字位置

文字位置在代码中通过坐标数组定义。如果您更换了模板图片，可能需要调整这些坐标以适应新的模板布局。

**坐标配置位置**：
```javascript
// 文字位置配置（坐标需根据实际模板图测量调整）
// 提示：使用PS/GIMP打开模板图，取文字左上角像素坐标
const positions = [
    { label: '始发地', labelX: 50, labelY: 100, valueX: 50, valueY: 130 },
    { label: '目的地', labelX: 50, labelY: 160, valueX: 50, valueY: 190 },
    { label: '称呼', labelX: 50, labelY: 220, valueX: 50, valueY: 250 },
    { label: '时间', labelX: 50, labelY: 280, valueX: 50, valueY: 310 }
];
```

**坐标测量方法**：
1. 使用图片编辑软件（如Photoshop、GIMP、在线图片编辑器）打开模板图片
2. 移动鼠标到您希望放置文字的位置
3. 记录该位置的像素坐标（X, Y）
4. 将记录的坐标更新到上面的配置数组中

### 3. 引入自定义字体

程序中已包含「汉仪尚巍手书」字体的引用示例，但需要您提供字体文件。

**引入自定义字体步骤**：
1. 下载字体文件（如 `HYShangWeiShouShuW.ttf`）
2. 将字体文件放置在与 `index.html` 同一目录下
3. 确保CSS中的 `@font-face` 定义正确：

```css
/* 自定义字体（汉仪尚巍手书） */
@font-face {
    font-family: 'HanYiShangWeiShouShu';
    src: url('HYShangWeiShouShuW.ttf') format('truetype');
    font-weight: normal;
    font-style: normal;
}
```

如果您使用的是其他字体，需要修改：
- `font-family` 的值（字体名称）
- `src` 中的文件路径和格式

然后在JavaScript中更新字体引用：

```javascript
// 文字绘制配置
const textConfig = {
    font: 'HanYiShangWeiShouShu, cursive', // 修改为您的字体名称
    // 其他配置...
};
```

### 4. 调整文字样式

文字样式可以通过修改 `textConfig` 对象进行调整：

```javascript
// 文字绘制配置
const textConfig = {
    font: 'HanYiShangWeiShouShu, cursive',
    labelSize: 20, // 标签文字大小
    valueSize: 18, // 用户输入值文字大小
    labelColor: '#5a3921', // 标签文字颜色
    valueColor: '#000000' // 用户输入值文字颜色
};
```

## 技术说明

### 浏览器兼容性
- 该程序基于HTML5 Canvas实现，建议使用现代浏览器（Chrome、Firefox、Edge等）
- 不支持IE11及以下版本

### 边界情况处理
- 用户输入为空时，会显示默认文字（如「未填写」、「未知时间」）
- 模板图片加载失败时，会提示用户检查图片路径
- 生成图片时会显示加载状态，防止用户重复点击

### 性能优化
- 使用Canvas直接绘制，避免DOM操作带来的性能损耗
- 图片生成过程异步处理，不阻塞主线程
- 下载功能使用Canvas的 `toDataURL()` 方法，无需额外依赖

## 常见问题

1. **图片不显示或显示异常**
   - 检查模板图片路径是否正确
   - 确认图片格式是否为JPG
   - 尝试刷新页面或清除浏览器缓存

2. **文字位置不正确**
   - 使用图片编辑软件重新测量坐标
   - 确保坐标单位是像素
   - 检查模板图片尺寸是否为800x500像素

3. **下载的图片质量不佳**
   - 确保原始模板图片分辨率足够高
   - 不要缩放Canvas元素（保持800x500像素）

4. **自定义字体不生效**
   - 检查字体文件路径是否正确
   - 确认字体格式是否被浏览器支持
   - 尝试在其他浏览器中测试

## 自定义开发

如果您需要进一步自定义功能，可以修改以下部分：

1. **添加更多输入字段**：
   - 在HTML表单中添加新的输入元素
   - 在JavaScript中获取新字段的值
   - 在 `positions` 数组中添加新的位置配置
   - 在 `drawText` 函数中绘制新字段

2. **修改页面样式**：
   - 修改CSS样式表中的颜色、字体、布局等
   - 调整按钮样式和交互效果

3. **增加更多功能**：
   - 添加图片滤镜效果
   - 支持多种模板选择
   - 实现图片预览缩放功能
   - 添加水印功能

## 许可证

本程序为开源项目，您可以自由使用、修改和分发，但请保留原作者信息。